<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Unit Price Dashboard</title>
<style>
  table { border-collapse: collapse; width: 100%; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: right; }
  th { background: #eee; }
</style>
</head>
<body>
<h2>Unit Price Dashboard</h2>
<table id="unitTable">
  <thead>
    <tr>
      <th>Timestamp (UTC)</th>
      <th>Unit USD</th>
      <th>Gold TWAP</th>
      <th>BRL</th>
      <th>RUB</th>
      <th>INR</th>
      <th>CNY</th>
      <th>ZAR</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const FX_LIST = ["BRL", "RUB", "INR", "CNY", "ZAR"];

async function tick() {
  try {
    const res = await fetch("/latest.json");
    const data = await res.json();

    const tbody = document.querySelector("#unitTable tbody");
    const tr = document.createElement("tr");

    tr.innerHTML = `
      <td>${data.timestamp_utc}</td>
      <td>${data.unitUSD.toFixed(2)}</td>
      <td>${data.goldTWAP.toFixed(2)}</td>
      ${FX_LIST.map(ccy => (data.fxTWAP[ccy]||0).toFixed(4)).join('')}
    `;

    tbody.prepend(tr);
    if (tbody.rows.length > 20) tbody.deleteRow(-1); // keep last 20
  } catch (err) {
    console.error(err);
  }
}

// Update every 5 seconds
tick();
setInterval(tick, 5000);
</script>
</body>
</html>
