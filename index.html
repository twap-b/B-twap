<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>BRICS Unit Basket</title>
<style>
body { background:#0b0f14; color:#ffd700; font-family:Arial; padding:20px; }
.container { max-width:960px; margin:auto; }
h1 { text-align:center; }
.box { background:#151a21; padding:20px; border-radius:8px; }
.row { margin:6px 0; }
#chart { height:420px; margin-top:20px; }
.fx { display:flex; justify-content:space-between; }
</style>
</head>
<body>

<div class="container">
<h1>BRICS Unit Basket – Live TWAP</h1>

<div class="box">
<div class="row">Unit USD: <b id="unit">—</b></div>
<div class="row">100 Units USD: <b id="hundred">—</b></div>
<div class="row">Gold TWAP (USD/oz): <b id="gold">—</b></div>
<div class="row">Unit Gold (g): <b id="grams">—</b></div>
<div class="row">Updated: <b id="ts">—</b></div>

<div id="fx"></div>
</div>

<div id="chart"></div>
</div>

<script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
<script>
const FX = ["BRL","RUB","INR","CNY","ZAR"];

const chart = LightweightCharts.createChart(
  document.getElementById("chart"),
  { layout:{backgroundColor:"#0b0f14",textColor:"#ffd700"} }
);
const series = chart.addCandlestickSeries();

FX.forEach(c=>{
  const d=document.createElement("div");
  d.className="fx";
  d.id="fx_"+c;
  d.innerHTML=`${c}: <b>—</b>`;
  document.getElementById("fx").appendChild(d);
});

async function tick(){
  const r = await fetch("/latest.json");
  const d = await r.json();

  document.getElementById("unit").innerText=d.unit_usd.toFixed(4);
  document.getElementById("hundred").innerText=d.hundred_units_usd.toFixed(2);
  document.getElementById("gold").innerText=d.gold_usd_per_oz_twap.toFixed(2);
  document.getElementById("grams").innerText=d.unit_gold_grams.toFixed(6);
  document.getElementById("ts").innerText=d.timestamp_utc;

  FX.forEach(c=>{
    const v = (1/d.fx_usd_twap[c]).toFixed(2);
    document.querySelector(`#fx_${c} b`).innerText=v;
  });

  const t = Math.floor(Date.now()/60000)*60;
  series.update({time:t, open:d.unit_usd, high:d.unit_usd, low:d.unit_usd, close:d.unit_usd});
}

tick();
setInterval(tick,1000);
</script>
</body>
</html>
